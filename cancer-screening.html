<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏≠‡∏õ‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Prompt', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-shadow { box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const CancerScreeningApp = () => {
            const [currentStep, setCurrentStep] = useState(0);
            const [formData, setFormData] = useState({
                age: '',
                gender: '',
                familyHistory: {},
                personalHistory: {},
                lifestyle: {},
                symptoms: {}
            });
            const [results, setResults] = useState(null);

            const cancerTypes = [
                {
                    name: '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏ô‡∏°',
                    screeningAge: { female: 40, male: null },
                    riskFactors: ['familyHistory', 'age', 'hormones'],
                    symptoms: ['‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏á‡∏≠‡∏Å', '‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏ß‡∏î', '‡∏´‡∏±‡∏ß‡∏ô‡∏°‡∏´‡∏•‡∏±‡πà‡∏á']
                },
                {
                    name: '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏õ‡∏≤‡∏Å‡∏°‡∏î‡∏•‡∏π‡∏Å',
                    screeningAge: { female: 25, male: null },
                    riskFactors: ['sexualActivity', 'smoking'],
                    symptoms: ['‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏≠‡∏≠‡∏Å‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥', '‡∏õ‡∏ß‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡πÄ‡∏û‡∏®‡∏™‡∏≥‡∏û‡∏±‡∏ô‡∏ò‡πå']
                },
                {
                    name: '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏•‡∏≥‡πÑ‡∏™‡πâ‡πÉ‡∏´‡∏ç‡πà',
                    screeningAge: { female: 50, male: 50 },
                    riskFactors: ['familyHistory', 'diet', 'smoking'],
                    symptoms: ['‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡πÉ‡∏ô‡∏≠‡∏∏‡∏à‡∏à‡∏≤‡∏£‡∏∞', '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏±‡∏ö‡∏ñ‡πà‡∏≤‡∏¢']
                },
                {
                    name: '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏ï‡∏±‡∏ö',
                    screeningAge: { female: 40, male: 40 },
                    riskFactors: ['hepatitisB', 'alcohol', 'familyHistory'],
                    symptoms: ['‡∏õ‡∏ß‡∏î‡∏ó‡πâ‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤', '‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏•‡∏î', '‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏ï‡∏≤']
                },
                {
                    name: '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏õ‡∏≠‡∏î',
                    screeningAge: { female: 50, male: 50 },
                    riskFactors: ['smoking', 'secondhandSmoke'],
                    symptoms: ['‡πÑ‡∏≠‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á', '‡πÑ‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏î', '‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏´‡∏≠‡∏ö']
                }
            ];

            const questions = [
                {
                    title: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ",
                    fields: [
                        { key: 'age', label: '‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ)', type: 'number', required: true },
                        { 
                            key: 'gender', 
                            label: '‡πÄ‡∏û‡∏®', 
                            type: 'radio', 
                            options: [
                                { value: 'female', label: '‡∏´‡∏ç‡∏¥‡∏á' },
                                { value: 'male', label: '‡∏ä‡∏≤‡∏¢' }
                            ], 
                            required: true 
                        }
                    ]
                },
                {
                    title: "‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß",
                    fields: [
                        { key: 'familyHistory.breast', label: '‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏ô‡∏°‡πÉ‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß', type: 'checkbox' },
                        { key: 'familyHistory.colorectal', label: '‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏•‡∏≥‡πÑ‡∏™‡πâ‡πÉ‡∏´‡∏ç‡πà‡πÉ‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß', type: 'checkbox' },
                        { key: 'familyHistory.liver', label: '‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏ï‡∏±‡∏ö‡πÉ‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß', type: 'checkbox' },
                        { key: 'familyHistory.lung', label: '‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏õ‡∏≠‡∏î‡πÉ‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß', type: 'checkbox' }
                    ]
                },
                {
                    title: "‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á",
                    fields: [
                        { key: 'personalHistory.smoking', label: '‡∏™‡∏π‡∏ö‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà', type: 'checkbox' },
                        { key: 'personalHistory.alcohol', label: '‡∏î‡∏∑‡πà‡∏°‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥', type: 'checkbox' },
                        { key: 'personalHistory.hepatitisB', label: '‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÑ‡∏ß‡∏£‡∏±‡∏™‡∏ï‡∏±‡∏ö‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö‡∏ö‡∏µ', type: 'checkbox' },
                        { key: 'lifestyle.exercise', label: '‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå', type: 'checkbox' },
                        { key: 'lifestyle.diet', label: '‡∏ö‡∏£‡∏¥‡πÇ‡∏†‡∏Ñ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏°‡∏±‡∏ô ‡∏ó‡∏≠‡∏î ‡πÄ‡∏Ñ‡πá‡∏° ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥', type: 'checkbox' }
                    ]
                },
                {
                    title: "‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏û‡∏ö",
                    fields: [
                        { key: 'symptoms.lump', label: '‡∏°‡∏µ‡∏Å‡πâ‡∏≠‡∏ô‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥', type: 'checkbox' },
                        { key: 'symptoms.bloodInStool', label: '‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡πÉ‡∏ô‡∏≠‡∏∏‡∏à‡∏à‡∏≤‡∏£‡∏∞', type: 'checkbox' },
                        { key: 'symptoms.chronicCough', label: '‡πÑ‡∏≠‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á', type: 'checkbox' },
                        { key: 'symptoms.weightLoss', label: '‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏•‡∏î‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏', type: 'checkbox' },
                        { key: 'symptoms.abdominalPain', label: '‡∏õ‡∏ß‡∏î‡∏ó‡πâ‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á', type: 'checkbox' }
                    ]
                }
            ];

            const getNestedValue = (obj, path) => {
                return path.split('.').reduce((current, key) => current?.[key], obj);
            };

            const setNestedValue = (obj, path, value) => {
                const keys = path.split('.');
                const lastKey = keys.pop();
                const target = keys.reduce((current, key) => {
                    if (!current[key]) current[key] = {};
                    return current[key];
                }, obj);
                target[lastKey] = value;
            };

            const handleInputChange = (key, value) => {
                setFormData(prev => {
                    const newData = { ...prev };
                    setNestedValue(newData, key, value);
                    return newData;
                });
            };

            const calculateRisk = () => {
                const age = parseInt(formData.age);
                const gender = formData.gender;
                const recommendations = [];

                cancerTypes.forEach(cancer => {
                    let riskLevel = '‡∏ï‡πà‡∏≥';
                    let shouldScreen = false;
                    let riskFactors = [];

                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á
                    const screeningAge = cancer.screeningAge[gender];
                    if (screeningAge && age >= screeningAge) {
                        shouldScreen = true;
                        riskFactors.push(`‡∏≠‡∏≤‡∏¢‡∏∏‡πÄ‡∏Å‡∏¥‡∏ô ${screeningAge} ‡∏õ‡∏µ`);
                    }

                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á
                    if (cancer.riskFactors.includes('familyHistory')) {
                        const familyKey = cancer.name === '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏ô‡∏°' ? 'breast' :
                                         cancer.name === '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏•‡∏≥‡πÑ‡∏™‡πâ‡πÉ‡∏´‡∏ç‡πà' ? 'colorectal' :
                                         cancer.name === '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏ï‡∏±‡∏ö' ? 'liver' : 'lung';
                        
                        if (formData.familyHistory[familyKey]) {
                            riskLevel = '‡∏™‡∏π‡∏á';
                            riskFactors.push('‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß');
                        }
                    }

                    if (cancer.riskFactors.includes('smoking') && formData.personalHistory?.smoking) {
                        riskLevel = '‡∏™‡∏π‡∏á';
                        riskFactors.push('‡∏™‡∏π‡∏ö‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà');
                    }

                    if (cancer.riskFactors.includes('alcohol') && formData.personalHistory?.alcohol) {
                        riskLevel = riskLevel === '‡∏™‡∏π‡∏á' ? '‡∏™‡∏π‡∏á' : '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á';
                        riskFactors.push('‡∏î‡∏∑‡πà‡∏°‡πÅ‡∏≠‡∏•‡∏Å‡∏≠‡∏Æ‡∏≠‡∏•‡πå');
                    }

                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏≤‡∏Å‡∏≤‡∏£
                    let hasSymptoms = false;
                    if (cancer.name === '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏ô‡∏°' && formData.symptoms?.lump) {
                        hasSymptoms = true;
                        riskFactors.push('‡∏°‡∏µ‡∏Å‡πâ‡∏≠‡∏ô‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥');
                    }
                    if (cancer.name === '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏•‡∏≥‡πÑ‡∏™‡πâ‡πÉ‡∏´‡∏ç‡πà' && formData.symptoms?.bloodInStool) {
                        hasSymptoms = true;
                        riskFactors.push('‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡πÉ‡∏ô‡∏≠‡∏∏‡∏à‡∏à‡∏≤‡∏£‡∏∞');
                    }
                    if (cancer.name === '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏õ‡∏≠‡∏î' && formData.symptoms?.chronicCough) {
                        hasSymptoms = true;
                        riskFactors.push('‡πÑ‡∏≠‡πÄ‡∏£‡∏∑‡πâ‡∏≠‡∏£‡∏±‡∏á');
                    }
                    if (cancer.name === '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏ï‡∏±‡∏ö' && (formData.symptoms?.abdominalPain || formData.symptoms?.weightLoss)) {
                        hasSymptoms = true;
                        if (formData.symptoms?.abdominalPain) riskFactors.push('‡∏õ‡∏ß‡∏î‡∏ó‡πâ‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤');
                        if (formData.symptoms?.weightLoss) riskFactors.push('‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏•‡∏î');
                    }

                    if (hasSymptoms) {
                        riskLevel = '‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å';
                    }

                    recommendations.push({
                        cancer: cancer.name,
                        riskLevel,
                        shouldScreen,
                        riskFactors,
                        hasSymptoms
                    });
                });

                setResults(recommendations);
            };

            const generateCarePlan = (recommendation) => {
                const plans = {
                    '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡πÄ‡∏ï‡πâ‡∏≤‡∏ô‡∏°': {
                        '‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å': '‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÇ‡∏î‡∏¢‡∏î‡πà‡∏ß‡∏ô, ‡∏ï‡∏£‡∏ß‡∏à mammography ‡πÅ‡∏•‡∏∞ ultrasound',
                        '‡∏™‡∏π‡∏á': '‡∏ï‡∏£‡∏ß‡∏à mammography ‡∏ó‡∏∏‡∏Å 1 ‡∏õ‡∏µ, ‡∏ï‡∏£‡∏ß‡∏à‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
                        '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á': '‡∏ï‡∏£‡∏ß‡∏à mammography ‡∏ó‡∏∏‡∏Å 2 ‡∏õ‡∏µ, ‡∏ï‡∏£‡∏ß‡∏à‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
                        '‡∏ï‡πà‡∏≥': '‡∏ï‡∏£‡∏ß‡∏à‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á, mammography ‡∏´‡∏•‡∏±‡∏á 40 ‡∏õ‡∏µ'
                    },
                    '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏õ‡∏≤‡∏Å‡∏°‡∏∏‡∏•‡∏°': {
                        '‡∏™‡∏π‡∏á': '‡∏ï‡∏£‡∏ß‡∏à Pap smear ‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ, ‡∏ï‡∏£‡∏ß‡∏à HPV',
                        '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á': '‡∏ï‡∏£‡∏ß‡∏à Pap smear ‡∏ó‡∏∏‡∏Å 2-3 ‡∏õ‡∏µ',
                        '‡∏ï‡πà‡∏≥': '‡∏ï‡∏£‡∏ß‡∏à Pap smear ‡∏ó‡∏∏‡∏Å 3 ‡∏õ‡∏µ ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ 25'
                    },
                    '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏•‡∏≥‡πÑ‡∏™‡πâ‡πÉ‡∏´‡∏ç‡πà': {
                        '‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å': '‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÇ‡∏î‡∏¢‡∏î‡πà‡∏ß‡∏ô, ‡∏ï‡∏£‡∏ß‡∏à colonoscopy',
                        '‡∏™‡∏π‡∏á': '‡∏ï‡∏£‡∏ß‡∏à colonoscopy ‡∏ó‡∏∏‡∏Å 3-5 ‡∏õ‡∏µ',
                        '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á': '‡∏ï‡∏£‡∏ß‡∏à FOBT ‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ, colonoscopy ‡∏ó‡∏∏‡∏Å 10 ‡∏õ‡∏µ',
                        '‡∏ï‡πà‡∏≥': '‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏≤‡∏¢‡∏∏ 50 ‡∏õ‡∏µ'
                    },
                    '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏ï‡∏±‡∏ö': {
                        '‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å': '‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÇ‡∏î‡∏¢‡∏î‡πà‡∏ß‡∏ô, ‡∏ï‡∏£‡∏ß‡∏à ultrasound + AFP',
                        '‡∏™‡∏π‡∏á': '‡∏ï‡∏£‡∏ß‡∏à ultrasound + AFP ‡∏ó‡∏∏‡∏Å 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
                        '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á': '‡∏ï‡∏£‡∏ß‡∏à ultrasound + AFP ‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ',
                        '‡∏ï‡πà‡∏≥': '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ'
                    },
                    '‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡∏õ‡∏≠‡∏î': {
                        '‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å': '‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÇ‡∏î‡∏¢‡∏î‡πà‡∏ß‡∏ô, ‡∏ï‡∏£‡∏ß‡∏à Low-dose CT',
                        '‡∏™‡∏π‡∏á': '‡∏ï‡∏£‡∏ß‡∏à Low-dose CT ‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ, ‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏π‡∏ö‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà',
                        '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á': '‡πÄ‡∏ù‡πâ‡∏≤‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏£, ‡πÄ‡∏•‡∏¥‡∏Å‡∏™‡∏π‡∏ö‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà',
                        '‡∏ï‡πà‡∏≥': '‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏ß‡∏±‡∏ô‡∏ö‡∏∏‡∏´‡∏£‡∏µ‡πà'
                    }
                };

                return plans[recommendation.cancer]?.[recommendation.riskLevel] || '‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°';
            };

            const exportToPDF = () => {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();

                // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡πÑ‡∏ó‡∏¢ (‡πÉ‡∏ä‡πâ‡∏ü‡∏≠‡∏ô‡∏ï‡πå default ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
                doc.setFont("helvetica");
                doc.setFontSize(16);
                doc.text('‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô', 20, 20);
                
                doc.setFontSize(12);
                doc.text(`‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô: ${new Date().toLocaleDateString('th-TH')}`, 20, 35);
                doc.text(`‡∏≠‡∏≤‡∏¢‡∏∏: ${formData.age} ‡∏õ‡∏µ`, 20, 45);
                doc.text(`‡πÄ‡∏û‡∏®: ${formData.gender === 'female' ? '‡∏´‡∏ç‡∏¥‡∏á' : '‡∏ä‡∏≤‡∏¢'}`, 20, 55);

                let yPosition = 75;
                
                results.forEach((result, index) => {
                    doc.setFontSize(14);
                    doc.text(`${index + 1}. ${result.cancer}`, 20, yPosition);
                    yPosition += 10;
                    
                    doc.setFontSize(10);
                    doc.text(`‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: ${result.riskLevel}`, 25, yPosition);
                    yPosition += 8;
                    
                    if (result.riskFactors.length > 0) {
                        doc.text(`‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: ${result.riskFactors.join(', ')}`, 25, yPosition);
                        yPosition += 8;
                    }
                    
                    const carePlan = generateCarePlan(result);
                    const lines = doc.splitTextToSize(`‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•: ${carePlan}`, 170);
                    doc.text(lines, 25, yPosition);
                    yPosition += lines.length * 6 + 10;

                    if (yPosition > 250) {
                        doc.addPage();
                        yPosition = 20;
                    }
                });

                doc.setFontSize(8);
                doc.text('‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥', 20, yPosition + 10);

                doc.save('cancer-screening-report.pdf');
            };

            const nextStep = () => {
                if (currentStep < questions.length - 1) {
                    setCurrentStep(currentStep + 1);
                } else {
                    calculateRisk();
                    setCurrentStep(questions.length);
                }
            };

            const prevStep = () => {
                if (currentStep > 0) {
                    setCurrentStep(currentStep - 1);
                }
            };

            const renderField = (field) => {
                const value = getNestedValue(formData, field.key) || '';

                switch (field.type) {
                    case 'number':
                        return (
                            <input
                                type="number"
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                value={value}
                                onChange={(e) => handleInputChange(field.key, e.target.value)}
                                required={field.required}
                                min="0"
                                max="120"
                            />
                        );
                    case 'radio':
                        return (
                            <div className="space-y-2">
                                {field.options.map(option => (
                                    <label key={option.value} className="flex items-center space-x-3 cursor-pointer">
                                        <input
                                            type="radio"
                                            name={field.key}
                                            value={option.value}
                                            checked={value === option.value}
                                            onChange={(e) => handleInputChange(field.key, e.target.value)}
                                            className="w-4 h-4 text-blue-600"
                                        />
                                        <span className="text-gray-700">{option.label}</span>
                                    </label>
                                ))}
                            </div>
                        );
                    case 'checkbox':
                        return (
                            <label className="flex items-center space-x-3 cursor-pointer">
                                <input
                                    type="checkbox"
                                    checked={Boolean(value)}
                                    onChange={(e) => handleInputChange(field.key, e.target.checked)}
                                    className="w-4 h-4 text-blue-600 rounded"
                                />
                                <span className="text-gray-700">‡∏°‡∏µ</span>
                            </label>
                        );
                    default:
                        return null;
                }
            };

            const getRiskColor = (riskLevel) => {
                switch (riskLevel) {
                    case '‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å': return 'bg-red-100 text-red-800 border-red-200';
                    case '‡∏™‡∏π‡∏á': return 'bg-orange-100 text-orange-800 border-orange-200';
                    case '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á': return 'bg-yellow-100 text-yellow-800 border-yellow-200';
                    case '‡∏ï‡πà‡∏≥': return 'bg-green-100 text-green-800 border-green-200';
                    default: return 'bg-gray-100 text-gray-800 border-gray-200';
                }
            };

            if (results) {
                return (
                    <div className="min-h-screen py-8">
                        <div className="max-w-4xl mx-auto px-4">
                            <div className="bg-white rounded-xl card-shadow p-8">
                                <h1 className="text-3xl font-bold text-center text-gray-800 mb-8">
                                    ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô
                                </h1>
                                
                                <div className="grid gap-6">
                                    {results.map((result, index) => (
                                        <div key={index} className="border rounded-lg p-6 hover:shadow-md transition-shadow">
                                            <div className="flex justify-between items-start mb-4">
                                                <h3 className="text-xl font-semibold text-gray-800">
                                                    {result.cancer}
                                                </h3>
                                                <span className={`px-3 py-1 rounded-full text-sm font-medium border ${getRiskColor(result.riskLevel)}`}>
                                                    {result.riskLevel}
                                                </span>
                                            </div>
                                            
                                            {result.riskFactors.length > 0 && (
                                                <div className="mb-4">
                                                    <p className="text-gray-600 mb-2">‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏ö:</p>
                                                    <ul className="list-disc list-inside text-gray-700 space-y-1">
                                                        {result.riskFactors.map((factor, i) => (
                                                            <li key={i}>{factor}</li>
                                                        ))}
                                                    </ul>
                                                </div>
                                            )}
                                            
                                            <div className="bg-blue-50 rounded-lg p-4">
                                                <p className="text-blue-800 font-medium mb-2">‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•:</p>
                                                <p className="text-blue-700">{generateCarePlan(result)}</p>
                                            </div>
                                        </div>
                                    ))}
                                </div>

                                <div className="mt-8 text-center space-y-4">
                                    <button
                                        onClick={exportToPDF}
                                        className="bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-8 rounded-lg transition-colors"
                                    >
                                        üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô PDF
                                    </button>
                                    
                                    <button
                                        onClick={() => {
                                            setResults(null);
                                            setCurrentStep(0);
                                            setFormData({
                                                age: '',
                                                gender: '',
                                                familyHistory: {},
                                                personalHistory: {},
                                                lifestyle: {},
                                                symptoms: {}
                                            });
                                        }}
                                        className="block mx-auto text-blue-600 hover:text-blue-800 underline"
                                    >
                                        ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡∏°‡πà
                                    </button>
                                </div>

                                <div className="mt-8 bg-yellow-50 border-l-4 border-yellow-400 p-4">
                                    <p className="text-yellow-800 text-sm">
                                        <strong>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á:</strong> ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô 
                                        ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏ó‡∏î‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡∏Ç‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÑ‡∏î‡πâ ‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen gradient-bg py-8">
                    <div className="max-w-2xl mx-auto px-4">
                        <div className="text-center mb-8">
                            <h1 className="text-4xl font-bold text-white mb-4">
                                ‡πÅ‡∏≠‡∏õ‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô
                            </h1>
                            <p className="text-white opacity-90">
                                ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô
                            </p>
                        </div>

                        <div className="bg-white rounded-xl card-shadow p-8">
                            <div className="mb-6">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-2xl font-bold text-gray-800">
                                        {questions[currentStep]?.title}
                                    </h2>
                                    <span className="text-sm text-gray-500">
                                        {currentStep + 1} / {questions.length}
                                    </span>
                                </div>
                                
                                <div className="w-full bg-gray-200 rounded-full h-2">
                                    <div 
                                        className="bg-blue-600 h-2 rounded-full transition-all duration-300"
                                        style={{ width: `${((currentStep + 1) / questions.length) * 100}%` }}
                                    ></div>
                                </div>
                            </div>

                            <div className="space-y-6">
                                {questions[currentStep]?.fields.map((field, index) => (
                                    <div key={index} className="space-y-2">
                                        <label className="block text-sm font-medium text-gray-700">
                                            {field.label}
                                            {field.required && <span className="text-red-500 ml-1">*</span>}
                                        </label>
                                        {renderField(field)}
                                    </div>
                                ))}
                            </div>

                            <div className="flex justify-between mt-8">
                                <button
                                    onClick={prevStep}
                                    disabled={currentStep === 0}
                                    className={`px-6 py-3 rounded-lg font-medium transition-colors ${
                                        currentStep === 0 
                                            ? 'bg-gray-200 text-gray-400 cursor-not-allowed' 
                                            : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                    }`}
                                >
                                    ‚Üê ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤
                                </button>

                                <button
                                    onClick={nextStep}
                                    className="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors"
                                >
                                    {currentStep === questions.length - 1 ? '‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•' : '‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí'}
                                </button>
                            </div>
                        </div>

                        <div className="mt-6 text-center">
                            <p className="text-white opacity-75 text-sm">
                                üîí ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ - ‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡πÉ‡∏î‡πÜ
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<CancerScreeningApp />, document.getElementById('root'));
    </script>
</body>
</html>
